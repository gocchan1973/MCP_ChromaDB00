{
  "analysis_timestamp": "2025-06-11T22:10:03.671616",
  "database_path": "F:\\副業\\VSC_WorkSpace\\IrukaWorkspace\\shared__ChromaDB_v4",
  "overall_status": "WARNING",
  "overall_score": 75.0,
  "status_description": "注意が必要",
  "layer_count": 5,
  "layer_results": [
    {
      "layer": "filesystem",
      "status": "excellent",
      "details": {
        "database_exists": true,
        "structure": {
          ".": [
            {
              "name": "chroma.sqlite3",
              "size": 3457024,
              "modified": "2025-06-11T22:07:35.360930"
            }
          ],
          "5dcd33ec-e239-4c0f-8346-7c51aa7acca5": [],
          "9171011f-fb97-4ccf-af12-1607ea265e6d": []
        },
        "total_size_bytes": 3457024,
        "total_size_mb": 3.3,
        "file_count": 1,
        "permissions": {
          "readable": true,
          "writable": true,
          "executable": true
        }
      },
      "score": 100
    },
    {
      "layer": "chromadb_api",
      "status": "excellent",
      "details": {
        "collections_count": 1,
        "collections": [
          {
            "name": "sister_chat_history_v4",
            "id": "96cce9b4-bb93-43d8-842f-129897a9c5d9",
            "metadata": {
              "description": "統合されたIrukaナレッジベース v4",
              "migration_version": "v4.0",
              "created_at": "2025-06-11T21:55:34.658944",
              "rename_timestamp": "2025-06-11T21:55:34.658954",
              "renamed_from": "merged_iruka_knowledge",
              "source_collections": "sister_chat_history, my_sister_context"
            }
          }
        ],
        "main_collection": {
          "name": "sister_chat_history_v4",
          "document_count": 105,
          "metadata": {
            "description": "統合されたIrukaナレッジベース v4",
            "migration_version": "v4.0",
            "created_at": "2025-06-11T21:55:34.658944",
            "rename_timestamp": "2025-06-11T21:55:34.658954",
            "renamed_from": "merged_iruka_knowledge",
            "source_collections": "sister_chat_history, my_sister_context"
          }
        },
        "search_tests": {
          "テスト": {
            "success": true,
            "result_count": 2
          },
          "姉妹": {
            "success": true,
            "result_count": 2
          },
          "会話": {
            "success": true,
            "result_count": 2
          }
        }
      },
      "score": 100
    },
    {
      "layer": "sqlite_internal",
      "status": "excellent",
      "details": {
        "sqlite_files": [
          "chroma.sqlite3"
        ],
        "sqlite_file_count": 1,
        "tables": [
          "migrations",
          "acquire_write",
          "collection_metadata",
          "segment_metadata",
          "tenants",
          "databases",
          "collections",
          "maintenance_log",
          "segments",
          "embeddings",
          "embedding_metadata",
          "max_seq_id",
          "embedding_fulltext_search",
          "embedding_fulltext_search_data",
          "embedding_fulltext_search_idx",
          "embedding_fulltext_search_content",
          "embedding_fulltext_search_docsize",
          "embedding_fulltext_search_config",
          "embeddings_queue",
          "embeddings_queue_config"
        ],
        "table_count": 20,
        "indexes": [
          "embedding_metadata_int_value",
          "embedding_metadata_float_value",
          "embedding_metadata_string_value"
        ],
        "index_count": 3,
        "views": [],
        "view_count": 0,
        "table_details": {
          "collection_metadata": {
            "row_count": 6,
            "column_count": 6,
            "columns": [
              "collection_id",
              "key",
              "str_value",
              "int_value",
              "float_value"
            ]
          },
          "segment_metadata": {
            "row_count": 0,
            "column_count": 6,
            "columns": [
              "segment_id",
              "key",
              "str_value",
              "int_value",
              "float_value"
            ]
          },
          "collections": {
            "row_count": 1,
            "column_count": 5,
            "columns": [
              "id",
              "name",
              "dimension",
              "database_id",
              "config_json_str"
            ]
          },
          "segments": {
            "row_count": 2,
            "column_count": 4,
            "columns": [
              "id",
              "type",
              "scope",
              "collection"
            ]
          },
          "embeddings": {
            "row_count": 210,
            "column_count": 5,
            "columns": [
              "id",
              "segment_id",
              "embedding_id",
              "seq_id",
              "created_at"
            ]
          },
          "embedding_metadata": {
            "row_count": 2250,
            "column_count": 6,
            "columns": [
              "id",
              "key",
              "string_value",
              "int_value",
              "float_value"
            ]
          },
          "embedding_fulltext_search": {
            "row_count": 210,
            "column_count": 1,
            "columns": [
              "string_value"
            ]
          },
          "embedding_fulltext_search_data": {
            "row_count": 131,
            "column_count": 2,
            "columns": [
              "id",
              "block"
            ]
          },
          "embedding_fulltext_search_idx": {
            "row_count": 129,
            "column_count": 3,
            "columns": [
              "segid",
              "term",
              "pgno"
            ]
          },
          "embedding_fulltext_search_content": {
            "row_count": 210,
            "column_count": 2,
            "columns": [
              "id",
              "c0"
            ]
          }
        },
        "database_size": {
          "pages": 844,
          "page_size": 4096,
          "total_bytes": 3457024,
          "total_mb": 3.3
        }
      },
      "score": 90
    },
    {
      "layer": "vector_embeddings",
      "status": "failed",
      "details": {
        "error": "Vector analysis error: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"
      },
      "score": 0
    },
    {
      "layer": "data_integrity",
      "status": "good",
      "details": {
        "analyzed_documents": 20,
        "total_documents": 105,
        "analysis_coverage": 19.0,
        "document_integrity": {
          "valid_documents": 20,
          "invalid_documents": 0,
          "validity_rate": 1.0
        },
        "metadata_integrity": {
          "valid_metadata": 20,
          "invalid_metadata": 0,
          "validity_rate": 1.0
        },
        "duplication_check": {
          "duplicate_documents": 0,
          "unique_documents": 20,
          "uniqueness_rate": 1.0
        },
        "search_integrity": {
          "test_results": {
            "日本語クエリ": "success",
            "英語クエリ": "success",
            "短いクエリ": "success",
            "長いクエリ": "success",
            "空クエリ": "skipped"
          },
          "successful_searches": 4,
          "total_valid_tests": 4,
          "success_rate": 1.0
        }
      },
      "score": 85
    }
  ],
  "summary": {
    "status_emoji": "⚠️",
    "recommendations": [
      "vector_embeddings層の修復: スコア0、即座の対応が必要",
      "一部層の改善により、さらなるパフォーマンス向上が期待できます"
    ],
    "health_metrics": {
      "average_score": 75.0,
      "min_score": 0,
      "max_score": 100,
      "score_range": 100,
      "excellent_layers": 3,
      "good_layers": 1,
      "warning_layers": 0,
      "failed_layers": 1,
      "healthy_percentage": 80.0,
      "total_layers": 5,
      "layer_distribution": {
        "excellent": 3,
        "failed": 1,
        "good": 1
      }
    },
    "strengths": [
      "filesystem層が優秀なパフォーマンス (100/100)",
      "chromadb_api層が優秀なパフォーマンス (100/100)",
      "sqlite_internal層が優秀なパフォーマンス (90/100)"
    ],
    "areas_for_improvement": [
      "vector_embeddings層の緊急修復が必要"
    ]
  }
}